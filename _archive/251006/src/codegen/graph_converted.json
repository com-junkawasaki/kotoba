{
  "dsl_metadata": {
    "version": "0.1.0",
    "description": "Kotobaグラフ構造定義 - Jsonnet DSL表現",
    "source": "src/graph/graph.rs",
    "generated": false,
    "generator": "jsonnet_dsl"
  },
  "types": {
    "VertexData": {
      "type": "struct",
      "description": "頂点データ",
      "fields": [
        {
          "name": "id",
          "type": "VertexId",
          "visibility": "pub",
          "description": "頂点ID"
        },
        {
          "name": "labels",
          "type": "Vec<Label>",
          "visibility": "pub",
          "description": "頂点のラベルリスト"
        },
        {
          "name": "props",
          "type": "Properties",
          "visibility": "pub",
          "description": "頂点のプロパティ"
        }
      ],
      "attributes": ["Debug", "Clone", "Serialize", "Deserialize"],
      "derives": []
    },
    "EdgeData": {
      "type": "struct",
      "description": "エッジデータ",
      "fields": [
        {
          "name": "id",
          "type": "EdgeId",
          "visibility": "pub",
          "description": "エッジID"
        },
        {
          "name": "src",
          "type": "VertexId",
          "visibility": "pub",
          "description": "始点頂点ID"
        },
        {
          "name": "dst",
          "type": "VertexId",
          "visibility": "pub",
          "description": "終点頂点ID"
        },
        {
          "name": "label",
          "type": "Label",
          "visibility": "pub",
          "description": "エッジラベル"
        },
        {
          "name": "props",
          "type": "Properties",
          "visibility": "pub",
          "description": "エッジのプロパティ"
        }
      ],
      "attributes": ["Debug", "Clone", "Serialize", "Deserialize"],
      "derives": []
    },
    "Graph": {
      "type": "struct",
      "description": "グラフ（列指向表現）",
      "fields": [
        {
          "name": "vertices",
          "type": "HashMap<VertexId, VertexData>",
          "visibility": "pub",
          "description": "頂点データ（ID→データ）"
        },
        {
          "name": "edges",
          "type": "HashMap<EdgeId, EdgeData>",
          "visibility": "pub",
          "description": "エッジデータ（ID→データ）"
        },
        {
          "name": "adj_out",
          "type": "HashMap<VertexId, HashSet<VertexId>>",
          "visibility": "pub",
          "description": "外向き隣接リスト（src→[dst]）"
        },
        {
          "name": "adj_in",
          "type": "HashMap<VertexId, HashSet<VertexId>>",
          "visibility": "pub",
          "description": "内向き隣接リスト（dst→[src]）"
        },
        {
          "name": "vertex_labels",
          "type": "HashMap<Label, HashSet<VertexId>>",
          "visibility": "pub",
          "description": "ラベル別頂点インデックス（ラベル→[頂点ID]）"
        },
        {
          "name": "edge_labels",
          "type": "HashMap<Label, HashSet<EdgeId>>",
          "visibility": "pub",
          "description": "ラベル別エッジインデックス（ラベル→[エッジID]）"
        }
      ],
      "attributes": ["Debug", "Clone"],
      "derives": [],
      "impls": [
        {
          "type": "method",
          "name": "empty",
          "signature": "pub fn empty() -> Self",
          "description": "空のグラフを作成",
          "body": "Self {\n                "vertices": "HashMap"::new(),\n                "edges": "HashMap"::new(),\n                "adj_out": "HashMap"::new(),\n                "adj_in": "HashMap"::new(),\n                "vertex_labels": "HashMap"::new(),\n                "edge_labels": "HashMap"::new(),\n            }"
        },
        {
          "type": "method",
          "name": "add_vertex",
          "signature": "pub fn add_vertex(&mut self, "vertex": VertexData) -> VertexId",
          "description": "頂点を追加",
          "body": "let id = vertex.id;\n            for label in &vertex.labels {\n                self.vertex_labels.entry(label.clone()).or_insert("HashSet"::new()).insert(id);\n            }\n            self.vertices.insert(id, vertex);\n            id"
        },
        {
          "type": "method",
          "name": "add_edge",
          "signature": "pub fn add_edge(&mut self, "edge": EdgeData) -> EdgeId",
          "description": "エッジを追加",
          "body": 'let id = edge.id;\n            let src = edge.src;\n            let dst = edge.dst;\n\n            
        },
        {
          "type": "method",
          "name": "get_vertex",
          "signature": "pub fn get_vertex(&self, "id": &VertexId) -> Option<&VertexData>",
          "description": "頂点を取得",
          "body": "self.vertices.get(id)"
        },
        {
          "type": "method",
          "name": "get_edge",
          "signature": "pub fn get_edge(&self, "id": &EdgeId) -> Option<&EdgeData>",
          "description": "エッジを取得",
          "body": "self.edges.get(id)"
        }
      ]
    }
  },
  "dependencies": {
    "external": [
      ""serde"::{Deserialize, Serialize}",
      ""std"::"collections"::{HashMap, HashSet}",
      ""parking_lot"::RwLock"
    ],
    "internal": [
      ""types"::*"
    ]
  },
  "codegen": {
    "target": "rust",
    "output_file": "src/graph/graph.rs",
    "template": "rust_type_template",
    "options": {
      "derive_serde": true,
      "derive_debug": true,
      "generate_docs": true,
      "include_tests": false
    }
  }
}
