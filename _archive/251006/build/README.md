# Build Directory

This directory contains all build outputs and generated artifacts from the Kotoba build process.

## Directory Structure

```
build/
├── site/                 # Static site output
│   ├── index.html       # Main site page
│   ├── assets/          # Static assets (CSS, JS)
│   ├── docs/            # Generated documentation
│   ├── CNAME            # GitHub Pages domain config
│   ├── robots.txt       # SEO configuration
│   └── sitemap.xml      # Site sitemap
├── ...                   # Other build outputs
```

## Site Output (`site/`)

The `site/` directory contains the complete static site generated by the Kotoba Static Site Generator (SSG). This includes:

- **Documentation**: Generated from Markdown sources
- **Assets**: Processed CSS, JavaScript, and templates
- **Pages**: Complete HTML pages with SEO optimization
- **Metadata**: Search engine configuration files

## Build Process

The build process follows the process network defined in `dag.jsonnet`:

1. **Source Processing**:
   - `ssg_assets`: CSS, JS, templates
   - `ssg_documentation`: Markdown content

2. **Content Generation**:
   - `markdown_parser`: Markdown → HTML
   - `html_template_engine`: Template processing
   - `documentation_builder`: Documentation site

3. **Site Assembly**:
   - `static_site_generator`: Complete site generation
   - `site_build_output`: Final output collection

## Deployment

The `site/` directory contents are deployment-ready:

```bash
# Deploy to GitHub Pages
cp -r build/site/* /path/to/gh-pages/

# Deploy to static hosting
rsync -avz build/site/ user@server:/var/www/

# Deploy to cloud storage
aws s3 sync build/site/ s3://my-bucket/
```

## Maintenance

### Automatic Generation
- Regenerated on each build cycle
- Should not be manually edited
- Version control typically excludes build outputs

### Cache Management
- Assets include cache-busting mechanisms
- Content updates automatically invalidate caches
- CDN integration supported

### SEO Optimization
- Automatic sitemap generation
- Meta tag optimization
- Search engine friendly URLs

## Development

### Local Development
```bash
# Build the site
cargo run --bin kotoba-ssg

# Serve locally for testing
cd build/site && python3 -m http.server 8000
```

### Continuous Integration
The build process is designed for CI/CD pipelines:

1. **Source changes** trigger build
2. **Generated site** deployed automatically
3. **SEO updates** applied on each build
4. **Asset optimization** performed automatically

## Configuration

Build configuration is managed through:

- **SSG Configuration**: `crates/kotoba-ssg/` settings
- **Template Variables**: Defined in templates
- **Asset Processing**: Configured in build pipeline
- **SEO Settings**: Meta tags and sitemap configuration

## Troubleshooting

### Common Issues

**Missing Assets**: Check `crates/kotoba-ssg/src/assets/`
**Broken Links**: Verify relative paths in templates
**SEO Problems**: Check generated meta tags
**Build Failures**: Verify source Markdown syntax

### Debugging

```bash
# Check build output
ls -la build/site/

# Validate HTML
tidy build/site/index.html

# Test links
linkchecker build/site/
```

## Integration

This build system integrates with:

- **GitHub Pages**: Automatic deployment
- **CDN**: CloudFlare, AWS CloudFront
- **CI/CD**: GitHub Actions, Jenkins
- **Monitoring**: Build metrics and alerts
